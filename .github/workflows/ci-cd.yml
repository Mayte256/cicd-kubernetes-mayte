name: CI/CD Pipeline - Mayte

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  validate-code:
    name: âœ… Validar CÃ³digo
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Descargar cÃ³digo
        uses: actions/checkout@v3
      
      - name: ğŸ Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: ğŸ“¦ Instalar dependencias
        run: |
          pip install -r app/requirements.txt
      
      - name: âœ… CÃ³digo validado
        run: |
          echo "âœ… CÃ³digo Python validado correctamente"

  validate-kubernetes:
    name: âœ… Validar Kubernetes
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Descargar cÃ³digo
        uses: actions/checkout@v3
      
      - name: ğŸ”§ Configurar kubectl
        uses: azure/setup-kubectl@v3
        with:
          version: 'latest'
      
      - name: ğŸ” Validar archivos YAML
        run: |
          echo "ğŸ” Validando archivos de Kubernetes..."
          kubectl apply --dry-run=client -f k8s/deployment.yaml
          echo "âœ… deployment.yaml es vÃ¡lido"
          kubectl apply --dry-run=client -f k8s/service.yaml
          echo "âœ… service.yaml es vÃ¡lido"

  summary:
    name: ğŸ“Š Resumen
    runs-on: ubuntu-latest
    needs: [validate-code, validate-kubernetes]
    
    steps:
      - name: ğŸ“Š Mostrar resumen
        run: |
          echo "================================"
          echo "   ğŸ‰ VALIDACIÃ“N COMPLETADA"
          echo "================================"
          echo "âœ… CÃ³digo Python validado"
          echo "âœ… Archivos Kubernetes validados"
          echo "================================"